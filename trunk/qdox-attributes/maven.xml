<?xml version="1.0"?>
<project default="jar" xmlns:j="jelly:core" xmlns:maven="jelly:maven">

  <goal name="jar:rt-jar" description="Create the deliverable jar file.">
    <jar jarfile="${maven.build.dir}/${maven.final.name}-rt.jar">
    	<fileset dir="${maven.build.dest}">
			<exclude name="**/*$Test*.class"/>
			<exclude name="com/thoughtworks/qdox/attributes/dev/*"/>
			<exclude name="com/thoughtworks/qdox/attributes/dev"/>
		</fileset>
	</jar>
  </goal>
  
  <postGoal name="jar:jar">
    <attainGoal name="jar:rt-jar"/>
  </postGoal>
  
  <goal name="java:attribs" description="Compile project attributes.">
  	<echo level="info" message="Compiling attributes" />
  	<java classname="com.thoughtworks.qdox.attributes.dev.Compiler" failonerror="true" fork="true">
  		<arg value="-mode" />
  		<arg value="object" />
  		<arg value="-force" />
  		<arg value="-src" />
  		<arg file="${maven.src.dir}/java" />
  		<arg value="-dst" />
  		<arg file="${maven.build.dest}" />
		<classpath>
			<path refid="maven.dependency.classpath"/>
			<pathelement location="${maven.build.dest}"/>
		</classpath>
  	</java>
  </goal>
  
  <postGoal name="java:compile">
  	<attainGoal name="java:attribs"/>
  </postGoal>
  
</project>

